<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script>
        async function handleSubmit(event) {
            event.preventDefault(); // Prevent form submission

    // Gather form data
    const formData = new FormData(event.target);
    const data = {
        name: formData.get('name'),
        email: formData.get('email'),
        student_no: formData.get('student_no'),
        mobile: formData.get('mobile'),
        year: parseInt(formData.get('year')), // Convert to number
        branch: formData.get('branch'),
        section: formData.get('section'),
        residence: formData.get('residence'),
        recaptcha_response: grecaptcha.getResponse()
    };

    // Log form data to console
    console.log('Request Data:', data);

    // Perform the registration API call
    const response = await fetch('http://127.0.0.1:8000/register', {
        method: 'POST',
        body: JSON.stringify(data), // Send JSON payload
        headers: {
            'Content-Type': 'application/json' // Set JSON Content-Type
        }
    });

    // Log the response to console
    const result = await response.json();
    console.log('Response:', result);

    // Handle success or failure
    if (response.ok) {
        alert('Registration successful!');
    } else {
        alert('Registration failed: ' + (result.detail || 'Unknown error'));
    }
}

    </script>
</head>
<body>
    <h1>Registration Form</h1>
    <form id="registrationForm" onsubmit="handleSubmit(event)">
        <label for="name">Name (2-50 characters):</label>
        <input type="text" id="name" name="name" required minlength="2" maxlength="50"><br><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="student_no">Student Number (21-24):</label>
        <input type="text" id="student_no" name="student_no" required pattern="^(21|22|23|24).*"><br><br>

        <label for="mobile">Mobile (10 digits):</label>
        <input type="text" id="mobile" name="mobile" required pattern="^[0-9]{10}$"><br><br>

        <label for="year">Year (1-4):</label>
        <input type="number" id="year" name="year" required min="1" max="4"><br><br>

        <label for="branch">Branch (2-50 characters):</label>
        <input type="text" id="branch" name="branch" required minlength="2" maxlength="50"><br><br>

        <label for="section">Section (1-5 characters):</label>
        <input type="text" id="section" name="section" required minlength="1" maxlength="5"><br><br>

        <label for="residence">Residence (2-100 characters):</label>
        <input type="text" id="residence" name="residence" required minlength="2" maxlength="100"><br><br>

        <!-- Google reCAPTCHA Widget -->
        <div class="g-recaptcha" data-sitekey="6Lcd2CMpAAAAAKLqwdxjTgnWwzSgAGEgtl0BVOng"></div><br><br>

        <button type="submit">Register</button>
    </form>
</body>
</html>


<!-- 
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>

<body>
    <form action="http://127.0.0.1:8000/register" method="POST">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required><br><br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <div class="g-recaptcha" data-sitekey="6Lcd2CMpAAAAAKLqwdxjTgnWwzSgAGEgtl0BVOng"></div><br><br>

        <button type="submit">Register</button>
    </form>
</body>

</html> -->